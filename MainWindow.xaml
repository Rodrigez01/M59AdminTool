<Window x:Class="M59AdminTool.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:M59AdminTool.Models"
        xmlns:converters="clr-namespace:M59AdminTool.Converters"
        xmlns:services="clr-namespace:M59AdminTool.Services"
        xmlns:wfi="clr-namespace:System.Windows.Forms.Integration;assembly=WindowsFormsIntegration"
        xmlns:quest="clr-namespace:QuestEditor.Views;assembly=QuestEditor"
        mc:Ignorable="d"
        Title="{services:Loc Window_Title}"
        Height="700" Width="1000"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanResize"
        Background="#F0F0F0">

    <Window.Resources>
        <!-- Converters -->
        <converters:NullToBooleanConverter x:Key="NullToBooleanConverter"/>

        <!-- Button Style -->
        <Style TargetType="Button">
            <Setter Property="Padding" Value="10,5"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="Background" Value="#4A90E2"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="3"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#357ABD"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#2E6DA4"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- TabControl Style -->
        <Style TargetType="TabControl">
            <Setter Property="Background" Value="Transparent"/>
        </Style>

        <Style TargetType="TabItem">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabItem">
                        <Border Name="Border"
                                Background="#E0E0E0"
                                BorderBrush="#C0C0C0"
                                BorderThickness="1,1,1,0"
                                CornerRadius="3,3,0,0"
                                Margin="2,0,2,0"
                                Padding="15,8">
                            <ContentPresenter x:Name="ContentSite"
                                            VerticalAlignment="Center"
                                            HorizontalAlignment="Center"
                                            ContentSource="Header"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="White"/>
                                <Setter TargetName="Border" Property="BorderThickness" Value="1,1,1,0"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#F5F5F5"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="#2C3E50" Padding="15">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Row="0" Grid.Column="0">
                    <TextBlock Text="{services:Loc Header_Title}"
                               FontSize="24"
                               FontWeight="Bold"
                               Foreground="White"/>
                    <TextBlock Text="{services:Loc Header_Subtitle}"
                               FontSize="12"
                               Foreground="#BDC3C7"
                               Margin="0,5,0,0"/>
                </StackPanel>

                <!-- Language Switch Button -->
                <StackPanel Grid.Row="0" Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Top">
                    <Button x:Name="BtnLanguage"
                            Click="BtnLanguage_Click"
                            Background="#34495E"
                            Padding="15,8"
                            Content="{Binding Source={x:Static services:LocalizationService.Instance}, Path=LanguageToggleLabel}" />
                </StackPanel>
            </Grid>
        </Border>

        <!-- Menu Bar -->
        <Menu Grid.Row="1" Background="#E0E0E0">
            <MenuItem Header="{services:Loc Menu_File}">
            </MenuItem>
            <MenuItem Header="{services:Loc Menu_Help}">
                <MenuItem Header="{services:Loc Menu_OpenHelp}" Click="Menu_OpenHelp_Click"/>
            </MenuItem>
        </Menu>

        <!-- Main Tab Control -->
        <TabControl Grid.Row="2" Margin="10" Background="White"
                    services:TabReorderBehavior.IsEnabled="True">
            <TabItem x:Name="ConnectionTab" Header="{services:Loc Tab_Connection}" Tag="Connection">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="20">
                        <!-- Header -->
                        <TextBlock Text="{services:Loc Header_Connection}"
                                   FontSize="20"
                                   FontWeight="Bold"
                                   Margin="0,0,0,20"/>

                        <!-- Connection Settings -->
                        <Border BorderBrush="#CCCCCC" BorderThickness="1" Padding="15" Margin="0,0,0,15" Background="White">
                            <StackPanel>
                                <TextBlock Text="{services:Loc Section_ConnectionSettings}" FontSize="14" FontWeight="Bold" Margin="0,0,0,10"/>

                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="250"/>
                                    </Grid.ColumnDefinitions>

                                    <!-- Server IP -->
                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="{services:Loc Label_ServerIp}" VerticalAlignment="Center" Margin="0,0,10,10"/>
                                    <TextBox Grid.Row="0" Grid.Column="1"
                                             Text="{Binding ConnectionVM.ServerIp, UpdateSourceTrigger=PropertyChanged}"
                                             VerticalAlignment="Center" Padding="5" Margin="0,0,0,10">
                                        <TextBox.InputBindings>
                                            <KeyBinding Key="Enter" Command="{Binding ConnectionVM.ConnectCommand}"/>
                                        </TextBox.InputBindings>
                                    </TextBox>

                                    <!-- Server Port -->
                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="{services:Loc Label_ServerPort}" VerticalAlignment="Center" Margin="0,0,10,10"/>
                                    <TextBox Grid.Row="1" Grid.Column="1"
                                             Text="{Binding ConnectionVM.ServerPort, UpdateSourceTrigger=PropertyChanged}"
                                             VerticalAlignment="Center" Padding="5" Margin="0,0,0,10">
                                        <TextBox.InputBindings>
                                            <KeyBinding Key="Enter" Command="{Binding ConnectionVM.ConnectCommand}"/>
                                        </TextBox.InputBindings>
                                    </TextBox>

                                    <!-- Username -->
                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="{services:Loc Label_Username}" VerticalAlignment="Center" Margin="0,0,10,10"/>
                                    <TextBox Grid.Row="2" Grid.Column="1"
                                             Text="{Binding ConnectionVM.Username, UpdateSourceTrigger=PropertyChanged}"
                                             VerticalAlignment="Center" Padding="5" Margin="0,0,0,10">
                                        <TextBox.InputBindings>
                                            <KeyBinding Key="Enter" Command="{Binding ConnectionVM.ConnectCommand}"/>
                                        </TextBox.InputBindings>
                                    </TextBox>

                                    <!-- Password -->
                                    <TextBlock Grid.Row="3" Grid.Column="0" Text="{services:Loc Label_Password}" VerticalAlignment="Center" Margin="0,0,10,10"/>
                                    <PasswordBox Grid.Row="3" Grid.Column="1"
                                                 x:Name="PasswordBox"
                                                 VerticalAlignment="Center" Padding="5" Margin="0,0,0,10"
                                                 PasswordChanged="PasswordBox_PasswordChanged">
                                        <PasswordBox.InputBindings>
                                            <KeyBinding Key="Enter" Command="{Binding ConnectionVM.ConnectCommand}"/>
                                        </PasswordBox.InputBindings>
                                    </PasswordBox>

                                    <!-- Secret Key -->
                                    <TextBlock Grid.Row="4" Grid.Column="0" Text="{services:Loc Label_SecretKey}" VerticalAlignment="Center" Margin="0,0,10,10"/>
                                    <TextBox Grid.Row="4" Grid.Column="1"
                                             Text="{Binding ConnectionVM.SecretKey, UpdateSourceTrigger=PropertyChanged}"
                                             VerticalAlignment="Center" Padding="5" Margin="0,0,0,10"/>

                                    <!-- Connection Buttons -->
                                    <StackPanel Grid.Row="5" Grid.Column="1" Orientation="Horizontal" Margin="0,10,0,0">
                                        <Button Content="{services:Loc Button_LoginConnect}"
                                                Command="{Binding ConnectionVM.ConnectCommand}"
                                                Background="#27AE60"
                                                Margin="0,0,10,0"/>
                                        <Button Content="{services:Loc Button_Disconnect}"
                                                Command="{Binding ConnectionVM.DisconnectCommand}"
                                                Background="#E74C3C"/>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>
                        </Border>

                        <!-- Connection Status -->
                        <Border BorderBrush="#CCCCCC" BorderThickness="1" Padding="15" Margin="0,0,0,15" Background="White">
                            <StackPanel>
                                <TextBlock Text="{services:Loc Label_Status}" FontSize="14" FontWeight="Bold" Margin="0,0,0,10"/>
                                <TextBlock Text="{Binding ConnectionVM.ConnectionStatus}"
                                           FontSize="13"
                                           FontFamily="Consolas"
                                           Foreground="#2C3E50"/>
                            </StackPanel>
                        </Border>

                        <!-- Debug Log -->
                        <Border BorderBrush="#CCCCCC" BorderThickness="1" Padding="15" Margin="0,0,0,15" Background="White">
                            <StackPanel>
                                <TextBlock Text="{services:Loc Section_DebugLog}" FontSize="14" FontWeight="Bold" Margin="0,0,0,10"/>
                                <Button Content="{services:Loc Button_OpenDebugLog}"
                                        Command="{Binding ConnectionVM.OpenDebugLogCommand}"
                                        Background="#9B59B6"
                                        Foreground="White"/>
                            </StackPanel>
                        </Border>

                        <!-- Test Command -->
                        <Border BorderBrush="#CCCCCC" BorderThickness="1" Padding="15" Margin="0,0,0,15" Background="White">
                            <StackPanel>
                                <TextBlock Text="{services:Loc Section_TestConnection}" FontSize="14" FontWeight="Bold" Margin="0,0,0,10"/>
                                <Button Content="{services:Loc Button_SendTestCommand}"
                                        Command="{Binding ConnectionVM.TestCommandCommand}"
                                        Background="#3498DB"/>
                            </StackPanel>
                        </Border>

                        <!-- Last Response -->
                        <Border BorderBrush="#CCCCCC" BorderThickness="1" Padding="15" Background="White">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="200"/>
                                </Grid.RowDefinitions>

                                <TextBlock Grid.Row="0" Text="{services:Loc Label_LastResponse}" FontSize="14" FontWeight="Bold" Margin="0,0,0,10"/>
                                <TextBox Grid.Row="1"
                                         Text="{Binding ConnectionVM.LastResponse, Mode=OneWay}"
                                         TextWrapping="Wrap"
                                         IsReadOnly="True"
                                         VerticalScrollBarVisibility="Auto"
                                         FontFamily="Consolas"
                                         FontSize="12"
                                         Padding="10"
                                         Background="#F5F5F5"/>
                            </Grid>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

<TabItem x:Name="WarpsTab" Header="{services:Loc Tab_Warps}" Tag="Warps">
                <Grid Margin="10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="300"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Left Panel: Warp Tree -->
                    <Border Grid.Column="0" BorderBrush="#CCCCCC" BorderThickness="1" Padding="10" Background="White">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0" Text="{services:Loc Header_WarpLocations}" FontSize="16" FontWeight="Bold" Margin="0,0,0,10"/>

                            <!-- Category Buttons -->
                            <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,10">
                                <Button Content="{services:Loc Button_AddCategory}" Command="{Binding AddCategoryCommand}" Padding="8,4" Margin="0,0,5,0"/>
                                <Button Content="{services:Loc Button_RemoveCategory}" Command="{Binding RemoveCategoryCommand}" Padding="8,4" Background="#E74C3C"/>
                            </StackPanel>

                            <!-- Search Box -->
                            <TextBox Grid.Row="2"
                                     Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                                     Margin="0,0,0,10"
                                     Padding="8"
                                     FontSize="14">
                                <TextBox.Style>
                                    <Style TargetType="TextBox">
                                        <Setter Property="Foreground" Value="Black"/>
                                        <Style.Triggers>
                                            <Trigger Property="Text" Value="">
                                                <Setter Property="Background">
                                                    <Setter.Value>
                                                        <VisualBrush Stretch="None" AlignmentX="Left">
                                                            <VisualBrush.Visual>
                                                                <TextBlock Text="{services:Loc Placeholder_SearchWarp}" Foreground="Gray" Margin="5,0,0,0"/>
                                                            </VisualBrush.Visual>
                                                        </VisualBrush>
                                                    </Setter.Value>
                                                </Setter>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBox.Style>
                            </TextBox>

                            <!-- TreeView for Warps -->
                            <TreeView Grid.Row="3" ItemsSource="{Binding FilteredWarpCategories}" BorderThickness="0" PreviewMouseDoubleClick="TreeView_MouseDoubleClick">
                                <TreeView.Resources>
                                    <HierarchicalDataTemplate DataType="{x:Type local:WarpCategoryView}" ItemsSource="{Binding Locations}">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="{Binding Name}" FontWeight="Bold" Foreground="#2C3E50"/>
                                            <TextBlock Text="{Binding Locations.Count, StringFormat=' ({0})'}" Foreground="Gray" Margin="5,0,0,0"/>
                                        </StackPanel>
                                    </HierarchicalDataTemplate>
                                    <DataTemplate DataType="{x:Type local:WarpLocation}">
                                        <TextBlock Text="{Binding DisplayName}"/>
                                    </DataTemplate>
                                </TreeView.Resources>
                                <TreeView.ItemContainerStyle>
                                    <Style TargetType="TreeViewItem">
                                        <Setter Property="IsExpanded" Value="{Binding IsExpanded, Mode=TwoWay}"/>
                                        <EventSetter Event="Selected" Handler="TreeViewItem_Selected"/>
                                    </Style>
                                </TreeView.ItemContainerStyle>
                            </TreeView>

                            <!-- Warp Buttons -->
                            <StackPanel Grid.Row="4" Margin="0,10,0,0">
                                <Button Content="{services:Loc Button_AddWarp}" Command="{Binding AddWarpCommand}" Margin="0,0,0,5"/>
                                <Button Content="{services:Loc Button_DeleteWarp}" Command="{Binding RemoveWarpCommand}" Background="#E74C3C" Margin="0,0,0,5"/>
                                <Button Content="{services:Loc Button_ExecuteWarp}" Command="{Binding ExecuteWarpCommand}" Background="#27AE60" Margin="0,0,0,10"/>

                                <Separator Margin="0,5"/>

                                <!-- File Operations -->
                                <Button Content="{services:Loc Button_Save}" Command="{Binding SaveAllWarpsCommand}" Margin="0,5,0,3" Background="#3498DB"/>
                                <Button Content="{services:Loc Button_Reload}" Command="{Binding ReloadWarpsCommand}" Margin="0,0,0,3" Background="#95A5A6"/>
                                <Button Content="{services:Loc Button_RefreshRooms}" Command="{Binding RefreshRoomsCommand}" Margin="0,0,0,3" Background="#7F8C8D"/>
                                <Button Content="{services:Loc Button_Export}" Command="{Binding ExportWarpsCommand}" Margin="0,0,0,3" Background="#16A085"/>
                                <Button Content="{services:Loc Button_Import}" Command="{Binding ImportWarpsCommand}" Margin="0,0,0,0" Background="#F39C12"/>

                                <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                                    <TextBlock Text="{services:Loc Label_Count}" Foreground="Gray"/>
                                    <TextBlock Text="{Binding FilteredWarpsCount}" Foreground="Gray" Margin="5,0,0,0"/>
                                </StackPanel>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- Right Panel: Edit Warp -->
                    <Border Grid.Column="1" BorderBrush="#CCCCCC" BorderThickness="1" Margin="10,0,0,0" Padding="20" Background="White">
                        <Grid IsEnabled="{Binding SelectedWarp, Converter={StaticResource NullToBooleanConverter}}">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0" Text="{services:Loc Header_EditWarp}" FontSize="16" FontWeight="Bold" Margin="0,0,0,20"/>

                            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                                <StackPanel>
                                    <TextBlock Text="{services:Loc Label_Name}" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                    <TextBox Text="{Binding EditName, UpdateSourceTrigger=PropertyChanged}" Margin="0,0,0,15" Padding="8"/>

                                    <TextBlock Text="{services:Loc Label_Category}" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                    <TextBox Text="{Binding EditCategory, UpdateSourceTrigger=PropertyChanged}" Margin="0,0,0,15" Padding="8" IsReadOnly="True" Background="#F5F5F5"/>

                                    <TextBlock Text="{services:Loc Label_RoomId}" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                    <TextBox Text="{Binding EditRoomId, UpdateSourceTrigger=PropertyChanged}" Margin="0,0,0,15" Padding="8"/>

                                    <Grid Margin="0,0,0,15">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="20"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>

                                        <StackPanel Grid.Column="0">
                                            <TextBlock Text="{services:Loc Label_XCoordinate}" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                            <TextBox Text="{Binding EditX, UpdateSourceTrigger=PropertyChanged}" Padding="8"/>
                                        </StackPanel>

                                        <StackPanel Grid.Column="2">
                                            <TextBlock Text="{services:Loc Label_YCoordinate}" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                            <TextBox Text="{Binding EditY, UpdateSourceTrigger=PropertyChanged}" Padding="8"/>
                                        </StackPanel>
                                    </Grid>

                                    <TextBlock Text="{services:Loc Label_Description}" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                    <TextBox Text="{Binding EditDescription, UpdateSourceTrigger=PropertyChanged}"
                                             TextWrapping="Wrap"
                                             AcceptsReturn="True"
                                             MinHeight="80"
                                             Padding="8"
                                             VerticalScrollBarVisibility="Auto"/>
                                </StackPanel>
                            </ScrollViewer>

                            <Button Grid.Row="2" Content="{services:Loc Button_SaveChanges}" Command="{Binding SaveWarpCommand}"
                                    Background="#27AE60" FontSize="14" Padding="15,10" Margin="0,20,0,0"/>
                        </Grid>
                    </Border>
                </Grid>
            </TabItem>

<TabItem x:Name="MonstersTab" Header="{services:Loc Tab_Monsters}" Tag="Monsters">
                <Grid Margin="10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="350"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Left Panel: Monster List -->
                    <Border Grid.Column="0" BorderBrush="#CCCCCC" BorderThickness="1" Padding="10" Background="White">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0" Text="{services:Loc Header_MonsterList}" FontSize="16" FontWeight="Bold" Margin="0,0,0,10"/>

                            <!-- Monster Action Buttons -->
                            <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,10">
                                <Button Content="{services:Loc Button_AddMonster}" Command="{Binding AddMonsterCommand}" Padding="8,4" Margin="0,0,5,0"/>
                                <Button Content="{services:Loc Button_RemoveMonster}" Command="{Binding RemoveMonsterCommand}" Padding="8,4" Background="#E74C3C"/>
                            </StackPanel>

                            <!-- Search Box -->
                            <TextBox Grid.Row="2"
                                     Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                                     Margin="0,0,0,10"
                                     Padding="8"
                                     FontSize="14">
                                <TextBox.Style>
                                    <Style TargetType="TextBox">
                                        <Setter Property="Foreground" Value="Black"/>
                                        <Style.Triggers>
                                            <Trigger Property="Text" Value="">
                                                <Setter Property="Background">
                                                    <Setter.Value>
                                                        <VisualBrush Stretch="None" AlignmentX="Left">
                                                            <VisualBrush.Visual>
                                                                <TextBlock Text="{services:Loc Placeholder_SearchMonster}" Foreground="Gray" Margin="5,0,0,0"/>
                                                            </VisualBrush.Visual>
                                                        </VisualBrush>
                                                    </Setter.Value>
                                                </Setter>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBox.Style>
                            </TextBox>

                            <!-- Monster ListBox -->
                            <ListBox Grid.Row="3"
                                     ItemsSource="{Binding FilteredMonsters}"
                                     SelectedItem="{Binding SelectedMonster}"
                                     BorderThickness="0"
                                     ScrollViewer.VerticalScrollBarVisibility="Auto"
                                     MouseDoubleClick="MonsterListBox_MouseDoubleClick">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <StackPanel Margin="5">
                                            <TextBlock Text="{Binding DisplayName}" FontWeight="SemiBold" FontSize="14"/>
                                            <TextBlock Text="{Binding ClassName}" Foreground="Gray" FontSize="11" Margin="0,2,0,0"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>

                            <!-- File Operations -->
                            <StackPanel Grid.Row="4" Margin="0,10,0,0">
                                <Separator Margin="0,5"/>
                                <Button Content="{services:Loc Button_Save}" Command="{Binding SaveAllMonstersCommand}" Margin="0,5,0,3" Background="#3498DB"/>
                                <Button Content="{services:Loc Button_Reload}" Command="{Binding ReloadMonstersCommand}" Margin="0,0,0,3" Background="#95A5A6"/>
                                <Button Content="{services:Loc Button_RefreshMonsters}" Command="{Binding RefreshMonstersCommand}" Margin="0,0,0,0" Background="#7F8C8D"/>

                                <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                                    <TextBlock Text="{services:Loc Label_Count}" Foreground="Gray"/>
                                    <TextBlock Text="{Binding FilteredMonstersCount}" Foreground="Gray" Margin="5,0,0,0"/>
                                </StackPanel>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- Right Panel: Monster Details -->
                    <Border Grid.Column="1" BorderBrush="#CCCCCC" BorderThickness="1" Margin="10,0,0,0" Padding="20" Background="White">
                        <Grid IsEnabled="{Binding SelectedMonster, Converter={StaticResource NullToBooleanConverter}}">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0" Text="{services:Loc Header_EditMonster}" FontSize="16" FontWeight="Bold" Margin="0,0,0,20"/>

                            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                                <StackPanel>
                                    <TextBlock Text="{services:Loc Label_ClassName}" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                    <TextBox Text="{Binding EditClassName, UpdateSourceTrigger=PropertyChanged}" Margin="0,0,0,15" Padding="8" FontFamily="Consolas"/>

                                    <TextBlock Text="{services:Loc Label_EnglishName}" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                    <TextBox Text="{Binding EditEnglishName, UpdateSourceTrigger=PropertyChanged}" Margin="0,0,0,15" Padding="8"/>

                                    <TextBlock Text="{services:Loc Label_GermanName}" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                    <TextBox Text="{Binding EditGermanName, UpdateSourceTrigger=PropertyChanged}" Margin="0,0,0,15" Padding="8"/>

                                    <TextBlock Text="{services:Loc Label_DmCommand}" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                    <TextBox Text="{Binding EditDmCommand, UpdateSourceTrigger=PropertyChanged}" Margin="0,0,0,15" Padding="8" FontFamily="Consolas"/>

                                    <TextBlock Text="{services:Loc Label_KodFile}" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                    <TextBlock Text="{Binding SelectedMonster.KodFile}" Foreground="Gray" Margin="0,0,0,15"/>
                                </StackPanel>
                            </ScrollViewer>

                            <StackPanel Grid.Row="2" Margin="0,20,0,0">
                                <Button Content="{services:Loc Button_SaveChanges}" Command="{Binding SaveMonsterCommand}"
                                        Background="#3498DB" FontSize="14" Padding="15,10" Margin="0,0,0,5"/>
                                <Button Content="{services:Loc Button_SpawnMonster}" Command="{Binding SpawnMonsterCommand}"
                                        Background="#27AE60" FontSize="14" Padding="15,10" Margin="0,0,0,0"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                </Grid>
            </TabItem>

<TabItem x:Name="ItemsTab" Header="{services:Loc Tab_Items}" Tag="Items">
                <Grid Margin="10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="350"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Left Panel: Item List -->
                    <Border Grid.Column="0" BorderBrush="#CCCCCC" BorderThickness="1" Padding="10" Background="White">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0" Text="{services:Loc Header_ItemList}" FontSize="16" FontWeight="Bold" Margin="0,0,0,10"/>

                            <!-- Item Action Buttons -->
                            <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,10">
                                <Button Content="{services:Loc Button_AddItem}" Command="{Binding AddItemCommand}" Padding="8,4" Margin="0,0,5,0"/>
                                <Button Content="{services:Loc Button_RemoveItem}" Command="{Binding RemoveItemCommand}" Padding="8,4" Background="#E74C3C"/>
                            </StackPanel>

                            <!-- Search Box -->
                            <TextBox Grid.Row="2"
                                     Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                                     Margin="0,0,0,10"
                                     Padding="8"
                                     FontSize="14">
                                <TextBox.Style>
                                    <Style TargetType="TextBox">
                                        <Setter Property="Foreground" Value="Black"/>
                                        <Style.Triggers>
                                            <Trigger Property="Text" Value="">
                                                <Setter Property="Background">
                                                    <Setter.Value>
                                                        <VisualBrush Stretch="None" AlignmentX="Left">
                                                            <VisualBrush.Visual>
                                                                <TextBlock Text="{services:Loc Placeholder_SearchItem}" Foreground="Gray" Margin="5,0,0,0"/>
                                                            </VisualBrush.Visual>
                                                        </VisualBrush>
                                                    </Setter.Value>
                                                </Setter>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBox.Style>
                            </TextBox>

                            <!-- Item ListBox -->
                            <ListBox Grid.Row="3"
                                     ItemsSource="{Binding FilteredItems}"
                                     SelectedItem="{Binding SelectedItem}"
                                     BorderThickness="0"
                                     ScrollViewer.VerticalScrollBarVisibility="Auto"
                                     MouseDoubleClick="ItemListBox_MouseDoubleClick">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <StackPanel Margin="5">
                                            <TextBlock Text="{Binding DisplayName}" FontWeight="SemiBold" FontSize="14"/>
                                            <TextBlock Text="{Binding ClassName}" Foreground="Gray" FontSize="11" Margin="0,2,0,0"/>
                                            <TextBlock Text="{Binding Category}" Foreground="DarkGray" FontSize="11"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>

                            <!-- File Operations -->
                            <StackPanel Grid.Row="4" Margin="0,10,0,0">
                                <Separator Margin="0,5"/>
                                <Button Content="{services:Loc Button_Save}" Command="{Binding SaveAllItemsCommand}" Margin="0,5,0,3" Background="#3498DB"/>
                                <Button Content="{services:Loc Button_Reload}" Command="{Binding ReloadItemsCommand}" Margin="0,0,0,3" Background="#95A5A6"/>
                                <Button Content="{services:Loc Button_RefreshItems}" Command="{Binding RefreshItemsCommand}" Margin="0,0,0,0" Background="#7F8C8D"/>

                                <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                                    <TextBlock Text="{services:Loc Label_Count}" Foreground="Gray"/>
                                    <TextBlock Text="{Binding FilteredItemsCount}" Foreground="Gray" Margin="5,0,0,0"/>
                                </StackPanel>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- Right Panel: Item Details -->
                    <Border Grid.Column="1" BorderBrush="#CCCCCC" BorderThickness="1" Margin="10,0,0,0" Padding="20" Background="White">
                        <Grid IsEnabled="{Binding SelectedItem, Converter={StaticResource NullToBooleanConverter}}">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0" Text="{services:Loc Header_EditItem}" FontSize="16" FontWeight="Bold" Margin="0,0,0,20"/>

                            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                                <StackPanel>
                                    <TextBlock Text="{services:Loc Label_ClassName}" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                    <TextBox Text="{Binding EditClassName, UpdateSourceTrigger=PropertyChanged}" Margin="0,0,0,15" Padding="8" FontFamily="Consolas"/>

                                    <TextBlock Text="{services:Loc Label_EnglishName}" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                    <TextBox Text="{Binding EditEnglishName, UpdateSourceTrigger=PropertyChanged}" Margin="0,0,0,15" Padding="8"/>

                                    <TextBlock Text="{services:Loc Label_GermanName}" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                    <TextBox Text="{Binding EditGermanName, UpdateSourceTrigger=PropertyChanged}" Margin="0,0,0,15" Padding="8"/>

                                    <TextBlock Text="{services:Loc Label_DmCommand}" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                    <TextBox Text="{Binding EditDmCommand, UpdateSourceTrigger=PropertyChanged}" Margin="0,0,0,15" Padding="8" FontFamily="Consolas"/>

                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,15" VerticalAlignment="Center">
                                        <TextBlock Text="{services:Loc Label_ItemQuantity}" FontWeight="SemiBold" Margin="0,0,5,0" VerticalAlignment="Center"/>
                                        <TextBox Text="{Binding SpawnQuantity, UpdateSourceTrigger=PropertyChanged}" Width="80" Padding="8" HorizontalContentAlignment="Center"/>
                                    </StackPanel>

                                    <TextBlock Text="{services:Loc Label_Category}" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                    <TextBox Text="{Binding EditCategory, UpdateSourceTrigger=PropertyChanged}" Margin="0,0,0,15" Padding="8"/>

                                    <TextBlock Text="{services:Loc Label_KodFile}" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                    <TextBlock Text="{Binding SelectedItem.KodFile}" Foreground="Gray" Margin="0,0,0,15"/>
                                </StackPanel>
                            </ScrollViewer>

                            <StackPanel Grid.Row="2" Margin="0,20,0,0">
                                <Button Content="{services:Loc Button_SaveChanges}" Command="{Binding SaveItemCommand}"
                                        Background="#3498DB" FontSize="14" Padding="15,10" Margin="0,0,0,5"/>
                                <Button Content="{services:Loc Button_SpawnItem}" Command="{Binding SpawnItemCommand}"
                                        Background="#27AE60" FontSize="14" Padding="15,10" Margin="0,0,0,0"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                </Grid>
            </TabItem>

<TabItem x:Name="DmTab" Header="{services:Loc Tab_Dm}" Tag="DM">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <Grid Margin="20">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0" Text="{services:Loc Header_DmCommands}" FontSize="20" FontWeight="Bold" Margin="0,0,0,20"/>

                        <Grid Grid.Row="1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <!-- Column 1: Player & Visibility -->
                            <StackPanel Grid.Column="0" Margin="0,0,10,0">
                                <Border BorderBrush="#CCCCCC" BorderThickness="1" Padding="15" Margin="0,0,0,15" Background="White">
                                    <StackPanel>
                                        <TextBlock Text="{services:Loc Section_DmPlayers}" FontSize="14" FontWeight="Bold" Margin="0,0,0,10"/>
                                        <UniformGrid Columns="2">
                                            <Button Content="{services:Loc Button_GotoPlayer}" Command="{Binding GotoPlayerCommand}" Margin="0,0,5,5" Background="#3498DB"/>
                                            <Button Content="{services:Loc Button_GetPlayer}" Command="{Binding GetPlayerCommand}" Margin="0,0,5,5" Background="#3498DB"/>
                                            <Button Content="{services:Loc Button_GoRoom}" Command="{Binding GoRoomCommand}" Margin="0,0,5,5" Background="#2980B9"/>
                                        </UniformGrid>
                                    </StackPanel>
                                </Border>

                                <Border BorderBrush="#CCCCCC" BorderThickness="1" Padding="15" Margin="0,0,0,15" Background="White">
                                    <StackPanel>
                                        <TextBlock Text="{services:Loc Section_DmVisibility}" FontSize="14" FontWeight="Bold" Margin="0,0,0,10"/>
                                        <UniformGrid Columns="2">
                                            <Button Content="{services:Loc Button_StealthOn}" Command="{Binding GoInvisibleCommand}" Margin="0,0,5,5" Background="#9B59B6"/>
                                            <Button Content="{services:Loc Button_StealthOff}" Command="{Binding GoVisibleCommand}" Margin="0,0,5,5" Background="#9B59B6"/>
                                            <Button Content="{services:Loc Button_Anonymous}" Command="{Binding GoAnonymousCommand}" Margin="0,0,5,5" Background="#8E44AD"/>
                                            <Button Content="{services:Loc Button_Blank}" Command="{Binding GoBlankCommand}" Margin="0,0,5,5" Background="#6C3483"/>
                                            <Button Content="{services:Loc Button_Hidden}" Command="{Binding GoHiddenCommand}" Margin="0,0,5,5" Background="#5B2C6F"/>
                                            <Button Content="{services:Loc Button_Shadow}" Command="{Binding GoShadowCommand}" Margin="0,0,5,5" Background="#4A235A"/>
                                        </UniformGrid>
                                    </StackPanel>
                                </Border>

                                <Border BorderBrush="#CCCCCC" BorderThickness="1" Padding="15" Margin="0,0,0,15" Background="White">
                                    <StackPanel>
                                        <TextBlock Text="{services:Loc Section_DmDisguise}" FontSize="14" FontWeight="Bold" Margin="0,0,0,10"/>
                                        <UniformGrid Columns="2">
                                            <Button Content="{services:Loc Button_Disguise}" Command="{Binding DisguiseCommand}" Margin="0,0,5,5" Background="#E67E22"/>
                                            <Button Content="{services:Loc Button_PlainForm}" Command="{Binding PlainFormCommand}" Margin="0,0,5,5" Background="#95A5A6"/>
                                            <Button Content="{services:Loc Button_HumanForm}" Command="{Binding HumanFormCommand}" Margin="0,0,5,5" Background="#7F8C8D"/>
                                        </UniformGrid>
                                    </StackPanel>
                                </Border>

                                <Border BorderBrush="#CCCCCC" BorderThickness="1" Padding="15" Margin="0,0,0,15" Background="White">
                                    <StackPanel>
                                        <TextBlock Text="{services:Loc Section_DmBoostKarma}" FontSize="14" FontWeight="Bold" Margin="0,0,0,10"/>
                                        <UniformGrid Columns="2">
                                            <Button Content="{services:Loc Button_BoostStats}" Command="{Binding BoostStatsCommand}" Margin="0,0,5,5" Background="#27AE60"/>
                                            <Button Content="{services:Loc Button_KarmaGood}" Command="{Binding SetKarmaGoodCommand}" Margin="0,0,5,5" Background="#3498DB"/>
                                            <Button Content="{services:Loc Button_KarmaNeutral}" Command="{Binding SetKarmaNeutralCommand}" Margin="0,0,5,5" Background="#95A5A6"/>
                                            <Button Content="{services:Loc Button_KarmaEvil}" Command="{Binding SetKarmaEvilCommand}" Margin="0,0,5,5" Background="#E74C3C"/>
                                        </UniformGrid>
                                    </StackPanel>
                                </Border>
                            </StackPanel>

                            <!-- Column 2: God Mode & Combat -->
                            <StackPanel Grid.Column="1" Margin="0,0,10,0">
                                <Border BorderBrush="#CCCCCC" BorderThickness="1" Padding="15" Margin="0,0,0,15" Background="White">
                                    <StackPanel>
                                        <TextBlock Text="{services:Loc Section_DmGodMode}" FontSize="14" FontWeight="Bold" Margin="0,0,0,10"/>
                                        <UniformGrid Columns="2">
                                            <Button Content="{services:Loc Button_ImmortalOn}" Command="{Binding GodModeOnCommand}" Margin="0,0,5,5" Background="#E74C3C"/>
                                            <Button Content="{services:Loc Button_MortalOff}" Command="{Binding GodModeOffCommand}" Margin="0,0,5,5" Background="#95A5A6"/>
                                        </UniformGrid>
                                    </StackPanel>
                                </Border>

                                <Border BorderBrush="#CCCCCC" BorderThickness="1" Padding="15" Margin="0,0,0,15" Background="White">
                                    <StackPanel>
                                        <TextBlock Text="{services:Loc Section_DmPkStatus}" FontSize="14" FontWeight="Bold" Margin="0,0,0,10"/>
                                        <UniformGrid Columns="2">
                                            <Button Content="{services:Loc Button_PkEnable}" Command="{Binding PkEnableCommand}" Margin="0,0,5,5" Background="#E67E22"/>
                                            <Button Content="{services:Loc Button_PkDisable}" Command="{Binding PkDisableCommand}" Margin="0,0,5,5" Background="#95A5A6"/>
                                            <Button Content="{services:Loc Button_PkLock}" Command="{Binding PkLockCommand}" Margin="0,0,5,5" Background="#C0392B"/>
                                            <Button Content="{services:Loc Button_PkUnlock}" Command="{Binding PkUnlockCommand}" Margin="0,0,5,5" Background="#27AE60"/>
                                            <Button Content="{services:Loc Button_SummonMonster}" Command="{Binding SummonMonsterCommand}" Margin="0,0,5,5" Background="#9B59B6"/>
                                        </UniformGrid>
                                    </StackPanel>
                                </Border>

                                <Border BorderBrush="#CCCCCC" BorderThickness="1" Padding="15" Margin="0,0,0,15" Background="White">
                                    <StackPanel>
                                        <TextBlock Text="{services:Loc Section_DmGetItems}" FontSize="14" FontWeight="Bold" Margin="0,0,0,10"/>
                                        <UniformGrid Columns="2">
                                            <Button Content="{services:Loc Button_GetSpells}" Command="{Binding GetSpellsCommand}" Margin="0,0,5,5" Background="#9B59B6"/>
                                            <Button Content="{services:Loc Button_GetSkills}" Command="{Binding GetSkillsCommand}" Margin="0,0,5,5" Background="#8E44AD"/>
                                            <Button Content="{services:Loc Button_GetMoney}" Command="{Binding GetMoneyCommand}" Margin="0,0,5,5" Background="#F1C40F"/>
                                            <Button Content="{services:Loc Button_GetItem}" Command="{Binding GetItemCommand}" Margin="0,0,5,5" Background="#3498DB"/>
                                            <Button Content="{services:Loc Button_GetAmmo}" Command="{Binding GetAmmoCommand}" Margin="0,0,5,5" Background="#E67E22"/>
                                            <Button Content="{services:Loc Button_GetRings}" Command="{Binding GetRingsCommand}" Margin="0,0,5,5" Background="#E74C3C"/>
                                            <Button Content="{services:Loc Button_GetWands}" Command="{Binding GetWandsCommand}" Margin="0,0,5,5" Background="#2ECC71"/>
                                            <Button Content="{services:Loc Button_GetNecklaces}" Command="{Binding GetNecklacesCommand}" Margin="0,0,5,5" Background="#16A085"/>
                                            <Button Content="{services:Loc Button_GetGems}" Command="{Binding GetGemsCommand}" Margin="0,0,5,5" Background="#D35400"/>
                                            <Button Content="{services:Loc Button_GetFood}" Command="{Binding GetSundriesCommand}" Margin="0,0,5,5" Background="#27AE60"/>
                                            <Button Content="{services:Loc Button_GetMisc}" Command="{Binding GetMiscCommand}" Margin="0,0,5,5" Background="#95A5A6"/>
                                            <Button Content="{services:Loc Button_CreateItemAttribute}" Command="{Binding CreateItemAttributeCommand}" Margin="0,0,5,5" Background="#8E44AD"/>
                                        </UniformGrid>
                                    </StackPanel>
                                </Border>
                            </StackPanel>

                            <!-- Column 3: Items & Time -->
                            <StackPanel Grid.Column="2" Margin="0,0,10,0">
                                <Border BorderBrush="#CCCCCC" BorderThickness="1" Padding="15" Margin="0,0,0,15" Background="White">
                                    <StackPanel>
                                        <TextBlock Text="{services:Loc Section_DmTime}" FontSize="14" FontWeight="Bold" Margin="0,0,0,10"/>
                                        <UniformGrid Columns="2">
                                            <Button Content="{services:Loc Button_TimeMorning}" Command="{Binding SetMorningCommand}" Margin="0,0,5,5" Background="#F39C12"/>
                                            <Button Content="{services:Loc Button_TimeAfternoon}" Command="{Binding SetAfternoonCommand}" Margin="0,0,5,5" Background="#F1C40F"/>
                                            <Button Content="{services:Loc Button_TimeEvening}" Command="{Binding SetEveningCommand}" Margin="0,0,5,5" Background="#E67E22"/>
                                            <Button Content="{services:Loc Button_TimeNight}" Command="{Binding SetNightCommand}" Margin="0,0,5,5" Background="#34495E"/>
                                            <Button Content="{services:Loc Button_TimeRestore}" Command="{Binding RestoreTimeCommand}" Margin="0,0,5,5" Background="#95A5A6"/>
                                        </UniformGrid>
                                    </StackPanel>
                                </Border>

                                <Border BorderBrush="#CCCCCC" BorderThickness="1" Padding="15" Margin="0,0,0,15" Background="White">
                                    <StackPanel>
                                        <TextBlock Text="{services:Loc Section_DmLights}" FontSize="14" FontWeight="Bold" Margin="0,0,0,10"/>
                                        <UniformGrid Columns="2">
                                            <Button Content="{services:Loc Button_LightCandle}" Command="{Binding PlaceCandleCommand}" Margin="0,0,5,5" Background="#FDE3A7"/>
                                            <Button Content="{services:Loc Button_LightCandelabra}" Command="{Binding PlaceCandelabraCommand}" Margin="0,0,5,5" Background="#F1C40F"/>
                                            <Button Content="{services:Loc Button_LightBrazier}" Command="{Binding PlaceBrazierCommand}" Margin="0,0,5,5" Background="#D35400"/>
                                            <Button Content="{services:Loc Button_LightLamp}" Command="{Binding PlaceLampCommand}" Margin="0,0,5,5" Background="#2980B9"/>
                                            <Button Content="{services:Loc Button_LightFirepit}" Command="{Binding PlaceFirepitCommand}" Margin="0,0,5,5" Background="#C0392B"/>
                                            <Button Content="{services:Loc Button_LightDynamic}" Command="{Binding PlaceDynamicLightCommand}" Margin="0,0,5,5" Background="#9B59B6"/>
                                        </UniformGrid>
                                    </StackPanel>
                                </Border>

                                <Border BorderBrush="#CCCCCC" BorderThickness="1" Padding="15" Margin="0,0,0,15" Background="White">
                                    <StackPanel>
                                        <TextBlock Text="{services:Loc Section_DmMapTour}" FontSize="14" FontWeight="Bold" Margin="0,0,0,10"/>
                                        <UniformGrid Columns="2">
                                            <Button Content="{services:Loc Button_ShowMap}" Command="{Binding ShowMapCommand}" Margin="0,0,5,5" Background="#3498DB"/>
                                            <Button Content="{services:Loc Button_HideMap}" Command="{Binding HideMapCommand}" Margin="0,0,5,5" Background="#95A5A6"/>
                                            <Button Content="{services:Loc Button_StartTour}" Command="{Binding StartTourCommand}" Margin="0,0,5,5" Background="#27AE60"/>
                                            <Button Content="{services:Loc Button_EndTour}" Command="{Binding EndTourCommand}" Margin="0,0,5,5" Background="#E74C3C"/>
                                        </UniformGrid>
                                    </StackPanel>
                                </Border>

                                <Border BorderBrush="#CCCCCC" BorderThickness="1" Padding="15" Margin="0,0,0,15" Background="White">
                                    <StackPanel>
                                        <TextBlock Text="{services:Loc Section_DmCommunication}" FontSize="14" FontWeight="Bold" Margin="0,0,0,10"/>
                                        <UniformGrid Columns="2">
                                            <Button Content="{services:Loc Button_DmMessage}" Command="{Binding SendDmMessageCommand}" Margin="0,0,5,5" Background="#8E44AD"/>
                                            <Button Content="{services:Loc Button_Echo}" Command="{Binding EchoMessageCommand}" Margin="0,0,5,5" Background="#9B59B6"/>
                                            <Button Content="{services:Loc Button_GChannel}" Command="{Binding OpenGChannelCommand}" Margin="0,0,5,5" Background="#2980B9"/>
                                            <Button Content="{services:Loc Button_ResetData}" Command="{Binding ResetDataCommand}" Margin="0,0,5,5" Background="#C0392B"/>
                                        </UniformGrid>
                                    </StackPanel>
                                </Border>
                            </StackPanel>

                            <!-- Column 4: Map & Misc -->
                            <StackPanel Grid.Column="3">
                                <Border BorderBrush="#CCCCCC" BorderThickness="1" Padding="15" Margin="0,0,0,15" Background="White">
                                    <StackPanel>
                                        <TextBlock Text="{services:Loc Section_DmTestCommands}" FontSize="14" FontWeight="Bold" Margin="0,0,0,10"/>
                                        <UniformGrid Columns="2">
                                            <Button Content="{services:Loc Button_TestMonsterGen}" Command="{Binding TestMonsterGenPointsCommand}" Margin="0,0,5,5" Background="#8E44AD"/>
                                            <Button Content="{services:Loc Button_TestExitPoints}" Command="{Binding TestExitPointsCommand}" Margin="0,0,5,5" Background="#9B59B6"/>
                                            <Button Content="{services:Loc Button_TestItemPoints}" Command="{Binding TestItemPointsCommand}" Margin="0,0,5,5" Background="#A569BD"/>
                                        </UniformGrid>
                                    </StackPanel>
                                </Border>

                                <Border BorderBrush="#CCCCCC" BorderThickness="1" Padding="15" Margin="0,0,0,15" Background="White">
                                    <StackPanel>
                                        <TextBlock Text="{services:Loc Section_DmLogoffGhost}" FontSize="14" FontWeight="Bold" Margin="0,0,0,10"/>
                                        <UniformGrid Columns="2">
                                            <Button Content="{services:Loc Button_GhostOn}" Command="{Binding LogoffGhostOnCommand}" Margin="0,0,5,5" Background="#27AE60"/>
                                            <Button Content="{services:Loc Button_GhostOff}" Command="{Binding LogoffGhostOffCommand}" Margin="0,0,5,5" Background="#E74C3C"/>
                                            <Button Content="{services:Loc Button_GhostTempOff}" Command="{Binding LogoffGhostTempOffCommand}" Margin="0,0,5,5" Background="#F39C12"/>
                                        </UniformGrid>
                                    </StackPanel>
                                </Border>

                                <Border BorderBrush="#CCCCCC" BorderThickness="1" Padding="15" Margin="0,0,0,15" Background="White">
                                    <StackPanel>
                                        <TextBlock Text="{services:Loc Section_DmMisc}" FontSize="14" FontWeight="Bold" Margin="0,0,0,10"/>
                                        <UniformGrid Columns="2">
                                            <Button Content="{services:Loc Button_ClearAbilities}" Command="{Binding ClearAbilitiesCommand}" Margin="0,0,5,5" Background="#E67E22"/>
                                            <Button Content="{services:Loc Button_ClearInventory}" Command="{Binding ClearInventoryCommand}" Margin="0,0,5,5" Background="#C0392B"/>
                                            <Button Content="{services:Loc Button_Rumble}" Command="{Binding RumbleCommand}" Margin="0,0,5,5" Background="#16A085"/>
                                            <Button Content="{services:Loc Button_Portal}" Command="{Binding PortalCommand}" Margin="0,0,5,5" Background="#2980B9"/>
                                            <Button Content="{services:Loc Button_GetTotem}" Command="{Binding GetTotemCommand}" Margin="0,0,5,5" Background="#D35400"/>
                                            <Button Content="{services:Loc Button_GetRelic}" Command="{Binding GetRelicCommand}" Margin="0,0,5,5" Background="#8E44AD"/>
                                            <Button Content="{services:Loc Button_NpcChat}" Command="{Binding NpcChatCommand}" Margin="0,0,5,5" Background="#27AE60"/>
                                            <Button Content="{services:Loc Button_AppealOn}" Command="{Binding AppealOnCommand}" Margin="0,0,5,5" Background="#3498DB"/>
                                            <Button Content="{services:Loc Button_AppealOff}" Command="{Binding AppealOffCommand}" Margin="0,0,5,5" Background="#95A5A6"/>
                                        </UniformGrid>
                                    </StackPanel>
                                </Border>

                                <Border BorderBrush="#CCCCCC" BorderThickness="1" Padding="15" Margin="0,0,0,15" Background="White">
                                    <StackPanel>
                                        <TextBlock Text="{services:Loc Section_DmCustomCommand}" FontSize="14" FontWeight="Bold" Margin="0,0,0,10"/>
                                        <TextBox Text="{Binding CustomCommand, UpdateSourceTrigger=PropertyChanged}"
                                                 Padding="8"
                                                 FontFamily="Consolas"
                                                 Margin="0,0,0,5">
                                            <TextBox.InputBindings>
                                                <KeyBinding Key="Enter" Command="{Binding ExecuteCustomCommandCommand}"/>
                                            </TextBox.InputBindings>
                                        </TextBox>
                                        <Button Content="{services:Loc Button_ExecuteCommand}" Command="{Binding ExecuteCustomCommandCommand}" Background="#34495E"/>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </Grid>
                    </Grid>
                </ScrollViewer>
            </TabItem>

<TabItem x:Name="AdminTab" Header="{services:Loc Tab_Admin}" Tag="Admin">
                <ScrollViewer x:Name="AdminScrollViewer"
                              VerticalScrollBarVisibility="Auto"
                              PreviewMouseWheel="AdminScrollViewer_PreviewMouseWheel">
                    <Grid Margin="20">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0" Text="{services:Loc Header_AdminCommands}" FontSize="20" FontWeight="Bold" Margin="0,0,0,20"/>

                        <Grid Grid.Row="1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="230"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="230"/>
                            </Grid.ColumnDefinitions>

                            <!-- Left Column: Objects/Player/Diagnostics -->
                            <StackPanel Grid.Column="0" Margin="0,0,10,0">
                                <Border BorderBrush="#CCCCCC" BorderThickness="1" Padding="15" Margin="0,0,0,15" Background="White" Width="210">
                                    <StackPanel>
                                        <TextBlock Text="{services:Loc Section_AdminObjects}" FontSize="14" FontWeight="Bold" Margin="0,0,0,10"/>
                                        <Button Content="{services:Loc Button_CreateObject}" Command="{Binding CreateObjectCommand}" Margin="0,0,0,5" Background="#3498DB" Height="30" Width="180"/>
                                        <Button Content="{services:Loc Button_ShowObject}" Command="{Binding ShowObjectCommand}" Margin="0,0,0,5" Background="#2ECC71" Height="30" Width="180"/>
                                        <Button Content="{services:Loc Button_DeleteObject}" Command="{Binding DeleteObjectCommand}" Margin="0,0,0,5" Background="#C0392B" Height="30" Width="180"/>
                                        <Button Content="{services:Loc Button_TeleportObject}" Command="{Binding TeleportObjectCommand}" Margin="0,0,0,5" Background="#9B59B6" Height="30" Width="180"/>
                                    </StackPanel>
                                </Border>

                                <Border BorderBrush="#CCCCCC" BorderThickness="1" Padding="15" Margin="0,0,0,15" Background="White" Width="210">
                                    <StackPanel>
                                        <TextBlock Text="{services:Loc Section_AdminPlayerManagement}" FontSize="14" FontWeight="Bold" Margin="0,0,0,10"/>
                                        <Button Content="{services:Loc Button_TeleportPlayerSafety}" Command="{Binding TeleportPlayerToSafetyCommand}" Margin="0,0,0,5" Background="#27AE60" Height="30" Width="180"/>
                                        <Button Content="{services:Loc Button_TeleportAllSafety}" Command="{Binding TeleportAllToSafetyCommand}" Margin="0,0,0,5" Background="#E67E22" Height="30" Width="180"/>
                                    </StackPanel>
                                </Border>

                            </StackPanel>

                            <!-- Center Column: 3-button groups + Responses -->
                            <StackPanel Grid.Column="1" Margin="0,0,10,0">
                                <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Disabled" Margin="0,0,0,15">
                                    <StackPanel Orientation="Horizontal">
                                        <Border BorderBrush="#CCCCCC" BorderThickness="1" Padding="15" Margin="0,0,10,0" Background="White" Width="210">
                                            <StackPanel>
                                                <TextBlock Text="{services:Loc Section_AdminAccounts}" FontSize="14" FontWeight="Bold" Margin="0,0,0,10"/>
                                                <Button Content="{services:Loc Button_CreateAdmin}" Command="{Binding CreateAdminAccountCommand}" Margin="0,0,0,5" Background="#E74C3C" Height="30" Width="180"/>
                                                <Button Content="{services:Loc Button_CreateDm}" Command="{Binding CreateDmAccountCommand}" Margin="0,0,0,5" Background="#E67E22" Height="30" Width="180"/>
                                                <Button Content="{services:Loc Button_CreateUser}" Command="{Binding CreateUserAccountCommand}" Margin="0,0,0,5" Background="#3498DB" Height="30" Width="180"/>
                                            </StackPanel>
                                        </Border>

                                        <Border BorderBrush="#CCCCCC" BorderThickness="1" Padding="15" Margin="0,0,10,0" Background="White" Width="210">
                                            <StackPanel>
                                                <TextBlock Text="{services:Loc Section_AdminSystem}" FontSize="14" FontWeight="Bold" Margin="0,0,0,10"/>
                                                <Button Content="{services:Loc Button_SaveGame}" Command="{Binding SaveGameCommand}" Margin="0,0,0,5" Background="#27AE60" Height="30" Width="180"/>
                                                <Button Content="{services:Loc Button_ReloadSystem}" Command="{Binding ReloadSystemCommand}" Margin="0,0,0,5" Background="#E67E22" Height="30" Width="180"/>
                                                <Button Content="{services:Loc Button_RecreateAll}" Command="{Binding RecreateGameCommand}" Margin="0,0,0,5" Background="#8E44AD" Height="30" Width="180"/>
                                            </StackPanel>
                                        </Border>

                                        <Border BorderBrush="#CCCCCC" BorderThickness="1" Padding="15" Margin="0,0,10,0" Background="White" Width="210">
                                            <StackPanel>
                                                <TextBlock Text="{services:Loc Section_AdminGlobalActions}" FontSize="14" FontWeight="Bold" Margin="0,0,0,10"/>
                                                <Button Content="{services:Loc Button_GlobalGiveItem}" Command="{Binding GlobalGiveItemCommand}" Margin="0,0,0,5" Background="#9B59B6" Height="30" Width="180"/>
                                                <Button Content="{services:Loc Button_UpdateHallOfHeroes}" Command="{Binding UpdateHallOfHeroesCommand}" Margin="0,0,0,5" Background="#F1C40F" Height="30" Width="180"/>
                                                <Button Content="{services:Loc Button_StartFrenzy}" Command="{Binding StartFrenzyCommand}" Margin="0,0,0,5" Background="#C0392B" Height="30" Width="180"/>
                                            </StackPanel>
                                        </Border>

                                        <Border BorderBrush="#CCCCCC" BorderThickness="1" Padding="15" Margin="0,0,10,0" Background="White" Width="210">
                                            <StackPanel>
                                                <TextBlock Text="{services:Loc Section_AdminResources}" FontSize="14" FontWeight="Bold" Margin="0,0,0,10"/>
                                                <Button Content="{services:Loc Button_CreateResource}" Command="{Binding CreateResourceCommand}" Margin="0,0,0,5" Background="#16A085" Height="30" Width="180"/>
                                                <Button Content="{services:Loc Button_ShowInstance}" Command="{Binding ShowInstanceCommand}" Margin="0,0,0,5" Background="#1ABC9C" Height="30" Width="180"/>
                                                <Button Content="{services:Loc Button_ShowMessage}" Command="{Binding ShowMessageCommand}" Margin="0,0,0,5" Background="#27AE60" Height="30" Width="180"/>
                                            </StackPanel>
                                        </Border>

                                        <Border BorderBrush="#CCCCCC" BorderThickness="1" Padding="15" Background="White" Width="210">
                                            <StackPanel>
                                                <TextBlock Text="{services:Loc Section_AdminAdvanced}" FontSize="14" FontWeight="Bold" Margin="0,0,0,10"/>
                                                <Button Content="{services:Loc Button_SendObjectCommand}" Command="{Binding SendObjectCommandCommand}" Margin="0,0,0,5" Background="#34495E" Height="30" Width="180"/>
                                                <Button Content="{services:Loc Button_SendClassCommand}" Command="{Binding SendClassCommandCommand}" Margin="0,0,0,5" Background="#2C3E50" Height="30" Width="180"/>
                                                <Button Content="{services:Loc Button_SetObjectProperty}" Command="{Binding SetObjectPropertyCommand}" Margin="0,0,0,5" Background="#7F8C8D" Height="30" Width="180"/>
                                            </StackPanel>
                                        </Border>
                                    </StackPanel>
                                </ScrollViewer>

                                <Border BorderBrush="#CCCCCC" BorderThickness="1" Padding="15" Margin="0,0,0,15" Background="White">
                                    <StackPanel>
                                        <TextBlock Text="{services:Loc Section_AdminResponses}" FontSize="14" FontWeight="Bold" Margin="0,0,0,10"/>
                                        <ListBox ItemsSource="{Binding AdminResponses}"
                                                 Height="450"
                                                 FontFamily="Consolas"
                                                 Background="#F8F8F8"
                                                 PreviewMouseWheel="ListBox_PreviewMouseWheel"
                                                 services:AutoScrollBehavior.AutoScrollToEnd="True"/>
                                        <TextBlock Text="{Binding LastAdminResponse}"
                                                   FontFamily="Consolas"
                                                   Margin="0,10,0,0"
                                                   TextWrapping="Wrap"/>
                                    </StackPanel>
                                </Border>

                                <Border BorderBrush="#CCCCCC" BorderThickness="1" Padding="15" Margin="0,0,0,15" Background="White">
                                    <StackPanel>
                                        <TextBlock Text="{services:Loc Section_AdminCustomCommand}" FontSize="14" FontWeight="Bold" Margin="0,0,0,10"/>
                                        <TextBox Text="{Binding CustomCommand, UpdateSourceTrigger=PropertyChanged}"
                                                 Padding="8"
                                                 FontFamily="Consolas"
                                                 Margin="0,0,0,5">
                                            <TextBox.InputBindings>
                                                <KeyBinding Key="Enter" Command="{Binding ExecuteCustomCommandCommand}"/>
                                            </TextBox.InputBindings>
                                        </TextBox>
                                        <Button Content="{services:Loc Button_ExecuteCommand}" Command="{Binding ExecuteCustomCommandCommand}" Background="#34495E" Height="30" Width="180"/>
                                    </StackPanel>
                                </Border>
                            </StackPanel>

                            <!-- Right Column: Spells/Server -->
                            <StackPanel Grid.Column="2">
                                <Border BorderBrush="#CCCCCC" BorderThickness="1" Padding="15" Margin="0,0,0,15" Background="White" Width="210">
                                    <StackPanel>
                                        <TextBlock Text="{services:Loc Section_AdminSpellsSkills}" FontSize="14" FontWeight="Bold" Margin="0,0,0,10"/>
                                        <Button Content="{services:Loc Button_GivePlayerSpell}" Command="{Binding GivePlayerSpellCommand}" Margin="0,0,0,5" Background="#9B59B6" Height="30" Width="180"/>
                                        <Button Content="{services:Loc Button_GivePlayerSkill}" Command="{Binding GivePlayerSkillCommand}" Margin="0,0,0,5" Background="#8E44AD" Height="30" Width="180"/>
                                        <Button Content="{services:Loc Button_GiveAllSpells}" Command="{Binding GiveAllPlayersSpellsCommand}" Margin="0,0,0,5" Background="#C0392B" Height="30" Width="180"/>
                                        <Button Content="{services:Loc Button_GiveAllSkills}" Command="{Binding GiveAllPlayersSkillsCommand}" Margin="0,0,0,5" Background="#E74C3C" Height="30" Width="180"/>
                                    </StackPanel>
                                </Border>
                                <Border BorderBrush="#CCCCCC" BorderThickness="1" Padding="15" Margin="0,0,0,15" Background="White" Width="210">
                                    <StackPanel>
                                        <TextBlock Text="{services:Loc Section_AdminServerSettings}" FontSize="14" FontWeight="Bold" Margin="0,0,0,10"/>
                                        <Button Content="{services:Loc Button_SetServerHour}" Command="{Binding SetServerHourCommand}" Margin="0,0,0,5" Background="#F39C12" Height="30" Width="180"/>
                                        <Button Content="{services:Loc Button_AddGameDay}" Command="{Binding AddGameDayCommand}" Margin="0,0,0,5" Background="#3498DB" Height="30" Width="180"/>
                                        <Button Content="{services:Loc Button_AddGameYear}" Command="{Binding AddGameYearCommand}" Margin="0,0,0,5" Background="#2980B9" Height="30" Width="180"/>
                                        <Button Content="{services:Loc Button_EnableSacredHaven}" Command="{Binding EnableSacredHavenCommand}" Margin="0,0,0,5" Background="#27AE60" Height="30" Width="180"/>
                                        <Button Content="{services:Loc Button_DisableSacredHaven}" Command="{Binding DisableSacredHavenCommand}" Margin="0,0,0,5" Background="#E74C3C" Height="30" Width="180"/>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </Grid>
                    </Grid>
                </ScrollViewer>
            </TabItem>

<TabItem Header="{services:Loc Tab_Dj}" Tag="DJ">
                <Grid Margin="10">
                    <TextBlock Text="{services:Loc Placeholder_DjComingSoon}"
                               HorizontalAlignment="Center"
                               VerticalAlignment="Center"
                               FontSize="16"
                               Foreground="Gray"/>
                </Grid>
            </TabItem>

<TabItem Header="{services:Loc Tab_Arena}" Tag="Arena">
                <Grid Margin="10">
                    <TextBlock Text="{services:Loc Placeholder_ArenaComingSoon}"
                               HorizontalAlignment="Center"
                               VerticalAlignment="Center"
                               FontSize="16"
                               Foreground="Gray"/>
                </Grid>
            </TabItem>

<TabItem x:Name="PlayersTab" Header="{services:Loc Tab_Players}" Tag="Players">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <StackPanel Grid.Row="0" Grid.ColumnSpan="2" Orientation="Horizontal" Margin="0,0,0,10">
                        <Button Content="{services:Loc Button_RefreshWho}" Command="{Binding RefreshCommand}" Width="150" Height="30" Background="#3498DB"/>
                    </StackPanel>
                    <Border Grid.Row="1" Grid.Column="0" BorderBrush="#CCCCCC" BorderThickness="1" Padding="10" Background="White">
                        <StackPanel>
                            <TextBlock Text="{services:Loc Header_OnlinePlayers}" FontSize="16" FontWeight="Bold" Margin="0,0,0,10"/>
                            <ListBox ItemsSource="{Binding Players}"
                                     FontFamily="Consolas"
                                     Background="#F8F8F8"
                                     DisplayMemberPath="Raw"
                                     MouseDoubleClick="PlayersList_MouseDoubleClick"
                                     PreviewMouseRightButtonDown="PlayersList_PreviewMouseRightButtonDown">
                                <ListBox.ContextMenu>
                                    <ContextMenu>
                                        <MenuItem Header="{services:Loc Menu_OpenInDeepInspector}"
                                                  Click="PlayersOpenDeepInspector_Click"/>
                                    </ContextMenu>
                                </ListBox.ContextMenu>
                            </ListBox>
                        </StackPanel>
                    </Border>
                    <Border Grid.Row="2" Grid.Column="0" BorderBrush="#CCCCCC" BorderThickness="1" Padding="10" Background="White" Margin="0,10,0,0">
                        <StackPanel>
                            <TextBlock Text="{services:Loc Header_Rooms}" FontSize="16" FontWeight="Bold" Margin="0,0,0,10"/>
                            <ListBox ItemsSource="{Binding Rooms}"
                                     FontFamily="Consolas"
                                     Background="#F8F8F8"/>
                        </StackPanel>
                    </Border>
                    <Border Grid.Row="1" Grid.Column="1" BorderBrush="#CCCCCC" BorderThickness="1" Padding="10" Background="White" Margin="10,0,0,0" Grid.RowSpan="2">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <TextBlock Grid.Row="0" Text="{services:Loc Header_PlayerDetails}" FontSize="16" FontWeight="Bold" Margin="0,0,0,10"/>
                            <ListBox Grid.Row="1"
                                     ItemsSource="{Binding PlayerDetails}"
                                     FontFamily="Consolas"
                                     Background="#F8F8F8"
                                     MouseDoubleClick="PlayerDetails_MouseDoubleClick"
                                     ScrollViewer.VerticalScrollBarVisibility="Auto"
                                     PreviewMouseWheel="PlayerDetails_PreviewMouseWheel"/>
                            <TextBlock Grid.Row="2"
                                        Text="{Binding LastPlayerDetail}"
                                        FontFamily="Consolas"
                                        Margin="0,10,0,0"
                                        TextWrapping="Wrap"/>
                            <Button Grid.Row="3"
                                    Content="{services:Loc Button_CopyDetails}"
                                    Command="{Binding CopyPlayerDetailsCommand}"
                                    Width="150"
                                    Height="30"
                                    Margin="0,10,0,0"/>
                        </Grid>
                    </Border>
                </Grid>
            </TabItem>

<TabItem x:Name="QuestEditorTab" Header="{services:Loc Tab_QuestEditor}" Tag="QuestEditor">
                <quest:QuestEditorHost />
            </TabItem>

<TabItem x:Name="DeepObjectInspectorTab" Header="{services:Loc Tab_DeepInspector}" Tag="DeepInspector">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Top Bar: Object ID Input -->
                    <Border Grid.Row="0" BorderBrush="#CCCCCC" BorderThickness="1" Padding="10" Background="White" Margin="0,0,0,10">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="200"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Grid.Column="0" Text="{services:Loc Label_ObjectId}" VerticalAlignment="Center" Margin="0,0,10,0" FontWeight="SemiBold"/>
                            <TextBox Grid.Column="1" Text="{Binding ObjectId, UpdateSourceTrigger=PropertyChanged}"
                                     VerticalAlignment="Center" Padding="5" FontFamily="Consolas" FontSize="14">
                                <TextBox.InputBindings>
                                    <KeyBinding Key="Enter" Command="{Binding LoadObjectCommand}"/>
                                </TextBox.InputBindings>
                            </TextBox>
                            <Button Grid.Column="2" Content="{services:Loc Button_Load}" Command="{Binding LoadObjectCommand}"
                                    Margin="10,0,0,0" Padding="10,5" Background="#3498DB" Foreground="White" BorderThickness="0"/>
                            <TextBlock Grid.Column="3" Text="{Binding CurrentInspection.DisplayHeader}"
                                       FontWeight="Bold" FontSize="14" Margin="20,0,0,0" VerticalAlignment="Center"/>
                        </Grid>
                    </Border>

                    <!-- Main Content: History + TreeView -->
                    <Grid Grid.Row="1">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="200"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <!-- Left Panel: Navigation History -->
                        <Border Grid.Column="0" BorderBrush="#CCCCCC" BorderThickness="1" Padding="10" Background="White">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <TextBlock Grid.Row="0" Text="{services:Loc Label_NavigationHistory}" FontWeight="Bold" FontSize="14" Margin="0,0,0,10"/>
                                <ListBox Grid.Row="1" ItemsSource="{Binding NavigationHistoryDisplay}"
                                         FontFamily="Consolas" FontSize="12" Background="#F8F8F8"
                                         ScrollViewer.VerticalScrollBarVisibility="Auto"
                                         MouseDoubleClick="DeepInspectorHistory_DoubleClick"/>
                                <Button Grid.Row="2" Content="{services:Loc Button_Back}" Command="{Binding NavigateBackCommand}"
                                        Margin="0,10,0,0" Padding="10,8" Background="#95A5A6" Foreground="White" BorderThickness="0"/>
                            </Grid>
                        </Border>

                        <!-- Right Panel: Property TreeView -->
                        <Border Grid.Column="1" BorderBrush="#CCCCCC" BorderThickness="1" Padding="15" Background="White" Margin="10,0,0,0">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <StackPanel Grid.Row="0" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,0,0,10">
                                    <Button Content="{services:Loc Button_Back}" Command="{Binding NavigateBackCommand}"
                                            IsEnabled="{Binding CanNavigateBack}"
                                            Margin="0,0,10,0" Padding="8,4" Background="#95A5A6" Foreground="White" BorderThickness="0"/>
                                    <Button Content="{services:Loc Button_Inventory}" Command="{Binding NavigateToNamedListCommand}"
                                            CommandParameter="inventory"
                                            Margin="0,0,10,0" Padding="8,4" Background="#D35400" Foreground="White" BorderThickness="0"/>
                                    <Button Content="{services:Loc Button_Spells}" Command="{Binding NavigateToNamedListCommand}"
                                            CommandParameter="plSpells"
                                            Margin="0,0,10,0" Padding="8,4" Background="#8E44AD" Foreground="White" BorderThickness="0"/>
                                    <Button Content="{services:Loc Button_Skills}" Command="{Binding NavigateToNamedListCommand}"
                                            CommandParameter="plSkills"
                                            Margin="0,0,10,0" Padding="8,4" Background="#16A085" Foreground="White" BorderThickness="0"/>
                                </StackPanel>

                                <TreeView Grid.Row="1"
                                          ItemsSource="{Binding CurrentInspection.PropertyGroups}"
                                          BorderThickness="0"
                                          services:AutoScrollBehavior.AutoScrollToEnd="True">
                                    <TreeView.Resources>
                                        <!-- Group Template -->
                                        <HierarchicalDataTemplate DataType="{x:Type local:PropertyGroup}" ItemsSource="{Binding Properties}">
                                            <TextBlock Text="{Binding DisplayName}" FontWeight="Bold" FontSize="14" Margin="0,5,0,5"/>
                                        </HierarchicalDataTemplate>

                                        <!-- Property Template -->
                                        <DataTemplate DataType="{x:Type local:ObjectProperty}">
                                            <StackPanel Orientation="Horizontal" Margin="0,3,0,3">
                                                <TextBlock Text="{Binding Name}" Width="200" FontFamily="Consolas" FontSize="12"/>
                                                <TextBlock Text="{services:Loc Label_Equals}" Margin="5,0"/>
                                                <TextBlock Text="{Binding DisplayValue}" FontFamily="Consolas" FontSize="12" Width="300"/>
                                                <Button Content="{services:Loc Button_Edit}"
                                                        Command="{Binding DataContext.EditPropertyCommand, RelativeSource={RelativeSource AncestorType=TreeView}}"
                                                        CommandParameter="{Binding}"
                                                        Visibility="{Binding IsEditable, Converter={StaticResource NullToBooleanConverter}}"
                                                        Margin="10,0,0,0" Padding="5,2"
                                                        Background="#3498DB" Foreground="White" BorderThickness="0" FontSize="11"/>
                                                <Button Content="{services:Loc Button_ListNavigate}"
                                                        Command="{Binding DataContext.NavigateToListCommand, RelativeSource={RelativeSource AncestorType=TreeView}}"
                                                        CommandParameter="{Binding ListId}"
                                                        Visibility="{Binding HasListTarget, Converter={StaticResource NullToBooleanConverter}}"
                                                        Margin="5,0,0,0" Padding="5,2"
                                                        Background="#8E44AD" Foreground="White" BorderThickness="0" FontSize="11"/>
                                                <Button Content="{services:Loc Button_Navigate}"
                                                        Command="{Binding DataContext.NavigateToObjectCommand, RelativeSource={RelativeSource AncestorType=TreeView}}"
                                                        CommandParameter="{Binding ReferencedObjectId}"
                                                        Visibility="{Binding HasReferenceTarget, Converter={StaticResource NullToBooleanConverter}}"
                                                        Margin="5,0,0,0" Padding="5,2"
                                                        Background="#27AE60" Foreground="White" BorderThickness="0" FontSize="11"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </TreeView.Resources>

                                    <TreeView.ItemContainerStyle>
                                        <Style TargetType="TreeViewItem">
                                            <Setter Property="IsExpanded" Value="{Binding IsExpanded, Mode=TwoWay}"/>
                                        </Style>
                                    </TreeView.ItemContainerStyle>
                                </TreeView>

                                <StackPanel Grid.Row="2" Margin="0,10,0,0">
                                    <TextBlock Text="{Binding StatusMessage}" FontSize="12" Foreground="Gray"/>
                                </StackPanel>
                            </Grid>
                        </Border>
                    </Grid>
                </Grid>
            </TabItem>

<TabItem x:Name="ListReaderTab" Header="{services:Loc Tab_ListReader}" Tag="ListReader">
                <Grid Margin="10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="400"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Left Panel: Query Controls and Results -->
                    <Border Grid.Column="0" BorderBrush="#CCCCCC" BorderThickness="1" Padding="15" Background="White">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <!-- Header -->
                            <TextBlock Grid.Row="0" Text="{services:Loc Header_ObjectListReader}" FontSize="16" FontWeight="Bold" Margin="0,0,0,15"/>

                            <!-- Query Controls -->
                            <StackPanel Grid.Row="1" Margin="0,0,0,15">
                                <TextBlock Text="{services:Loc Label_CommandType}" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                <ComboBox ItemsSource="{Binding CommandTypes}"
                                          SelectedItem="{Binding SelectedCommandType}"
                                          DisplayMemberPath="DisplayName"
                                          Margin="0,0,0,10"
                                          Padding="8"
                                          FontSize="14"/>

                                <TextBlock Text="{services:Loc Label_ClassName}" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                <ComboBox ItemsSource="{Binding SystemClasses}"
                                          SelectedItem="{Binding SelectedSystemClass}"
                                          Text="{Binding ClassName, UpdateSourceTrigger=PropertyChanged}"
                                          IsEditable="True"
                                          IsTextSearchEnabled="True"
                                          Padding="8"
                                          FontFamily="Consolas"
                                          FontSize="14"
                                          Margin="0,0,0,10">
                                    <ComboBox.InputBindings>
                                        <KeyBinding Key="Enter" Command="{Binding ExecuteQueryCommand}"/>
                                    </ComboBox.InputBindings>
                                </ComboBox>

                                <TextBlock Text="{services:Loc Label_ImportantLists}" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                <ComboBox ItemsSource="{Binding ImportantLists}"
                                          SelectedItem="{Binding SelectedImportantList}"
                                          DisplayMemberPath="DisplayName"
                                          Margin="0,0,0,10"
                                          Padding="8"
                                          FontSize="14"/>

                                <Button Content="{services:Loc Button_ExecuteQuery}"
                                        Command="{Binding ExecuteQueryCommand}"
                                        Background="#3498DB"
                                        Foreground="White"
                                        FontSize="14"
                                        Padding="10,8"
                                        BorderThickness="0"/>
                            </StackPanel>

                            <!-- Search Box -->
                            <TextBox Grid.Row="2"
                                     Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                                     Margin="0,0,0,10"
                                     Padding="8"
                                     FontSize="14">
                                <TextBox.Style>
                                    <Style TargetType="TextBox">
                                        <Setter Property="Foreground" Value="Black"/>
                                        <Style.Triggers>
                                            <Trigger Property="Text" Value="">
                                                <Setter Property="Background">
                                                    <Setter.Value>
                                                        <VisualBrush Stretch="None" AlignmentX="Left">
                                                            <VisualBrush.Visual>
                                                                <TextBlock Text="{services:Loc Placeholder_FilterResults}" Foreground="Gray" Margin="5,0,0,0"/>
                                                            </VisualBrush.Visual>
                                                        </VisualBrush>
                                                    </Setter.Value>
                                                </Setter>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBox.Style>
                            </TextBox>

                            <!-- Results List -->
                            <ListBox Grid.Row="3"
                                     ItemsSource="{Binding FilteredResults}"
                                     SelectedItem="{Binding SelectedResult}"
                                     BorderThickness="0"
                                     FontFamily="Consolas"
                                     FontSize="12"
                                     MouseDoubleClick="ListReaderResults_MouseDoubleClick"
                                     ScrollViewer.VerticalScrollBarVisibility="Auto">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <StackPanel Margin="5">
                                            <TextBlock Text="{Binding DisplayText}" FontWeight="SemiBold"/>
                                            <TextBlock Text="{Binding ObjectId}" Foreground="Gray" FontSize="10" Margin="0,2,0,0"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>

                            <!-- Action Buttons -->
                            <StackPanel Grid.Row="4" Margin="0,10,0,0">
                                <Button Content="{services:Loc Button_ShowDetails}"
                                        Command="{Binding ShowObjectDetailsCommand}"
                                        Margin="0,0,0,5"
                                        Padding="10,8"
                                        FontSize="14"
                                        Background="#2ECC71"
                                        Foreground="White"
                                        BorderThickness="0"/>
                                <Button Content="{services:Loc Button_ClearResults}"
                                        Command="{Binding ClearResultsCommand}"
                                        Margin="0,0,0,5"
                                        Padding="10,8"
                                        FontSize="14"
                                        Background="#E74C3C"
                                        Foreground="White"
                                        BorderThickness="0"/>
                                <Button Content="{services:Loc Button_ExportResults}"
                                        Command="{Binding ExportResultsCommand}"
                                        Padding="10,8"
                                        FontSize="14"
                                        Background="#F39C12"
                                        Foreground="White"
                                        BorderThickness="0"/>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- Right Panel: Object Details -->
                    <Border Grid.Column="1" BorderBrush="#CCCCCC" BorderThickness="1" Margin="10,0,0,0" Padding="20" Background="White">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0"
                                       Text="{services:Loc Header_ObjectDetails}"
                                       FontSize="16"
                                       FontWeight="Bold"
                                       Margin="0,0,0,15"/>

                            <ListBox Grid.Row="1"
                                     ItemsSource="{Binding DetailLines}"
                                     FontFamily="Consolas"
                                     FontSize="12"
                                     Background="#F8F8F8"
                                     SelectionMode="Extended"
                                     ScrollViewer.VerticalScrollBarVisibility="Auto"
                                     PreviewKeyDown="ListReaderDetails_PreviewKeyDown"
                                     MouseDoubleClick="ListReaderDetails_MouseDoubleClick"
                                     PreviewMouseWheel="ListBox_PreviewMouseWheel"
                                     services:AutoScrollBehavior.AutoScrollToEnd="True">
                                <ListBox.ContextMenu>
                                    <ContextMenu>
                                        <MenuItem Header="{services:Loc Menu_OpenList}"
                                                  Click="ListReaderDetails_OpenList_Click"/>
                                        <MenuItem Header="{services:Loc Menu_EditInt}"
                                                  Click="ListReaderDetails_EditInt_Click"/>
                                        <MenuItem Header="{services:Loc Menu_CopySelected}"
                                                  Click="ListReaderDetails_CopySelected_Click"/>
                                        <MenuItem Header="{services:Loc Menu_CopyAll}"
                                                  Click="ListReaderDetails_CopyAll_Click"/>
                                    </ContextMenu>
                                </ListBox.ContextMenu>
                            </ListBox>

                            <StackPanel Grid.Row="2" Margin="0,10,0,0">
                                <TextBlock Text="{Binding StatusMessage}"
                                           FontSize="12"
                                           Foreground="Gray"
                                           Margin="0,0,0,5"/>
                                <TextBlock Text="{Binding LastResponse}"
                                           FontFamily="Consolas"
                                           FontSize="11"
                                           Foreground="DarkGray"
                                           TextWrapping="Wrap"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                </Grid>
            </TabItem>

<TabItem x:Name="AdminConsoleTab" Header="{services:Loc Tab_AdminConsole}" Tag="AdminConsole">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" Text="{services:Loc Header_AdminConsole}" FontSize="18" FontWeight="Bold" Margin="0,0,0,10"/>

                    <Border Grid.Row="1" BorderBrush="#CCCCCC" BorderThickness="1" Padding="10" Background="White">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <ListBox Grid.Row="0"
                                     ItemsSource="{Binding AdminResponses}"
                                     FontFamily="Consolas"
                                     Background="#F8F8F8"
                                     PreviewMouseWheel="ListBox_PreviewMouseWheel"
                                     services:AutoScrollBehavior.AutoScrollToEnd="True"/>
                            <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,10,0,0">
                                <TextBlock Text="{services:Loc Label_LastResponseInline}" FontWeight="Bold" Margin="0,0,5,0"/>
                                <TextBlock Text="{Binding LastAdminResponse}" FontFamily="Consolas" TextWrapping="Wrap"/>
                            </StackPanel>
                            <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,10,0,0">
                                <Button Content="{services:Loc Button_CopyAll}" Command="{Binding CopyAdminResponsesCommand}" Width="120" Height="30"/>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,10,0,0">
                        <TextBox Width="400"
                                 Text="{Binding CustomCommand, UpdateSourceTrigger=PropertyChanged}"
                                 FontFamily="Consolas"
                                 Margin="0,0,10,0">
                            <TextBox.InputBindings>
                                <KeyBinding Key="Enter" Command="{Binding ExecuteCustomCommandCommand}"/>
                            </TextBox.InputBindings>
                        </TextBox>
                        <Button Content="{services:Loc Button_SendCommand}" Command="{Binding ExecuteCustomCommandCommand}" Background="#34495E" Height="30" Width="150"/>
                    </StackPanel>
                </Grid>
            </TabItem>

<TabItem x:Name="EventManagerTab" Header="{services:Loc Tab_EventManager}" Tag="EventManager">
                <Grid Margin="10">
                    <wfi:WindowsFormsHost x:Name="EventManagerHost"/>
                </Grid>
            </TabItem>

            <TabItem x:Name="BGFConverterTab" Header="BGF Converter" Tag="BGFConverter">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <Grid Margin="20">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Title -->
                        <TextBlock Grid.Row="0" Text="BGF Converter (BMP → BGF)"
                                   FontSize="20" FontWeight="Bold" Margin="0,0,0,20"/>

                        <!-- Main Content Grid -->
                        <Grid Grid.Row="1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="350"/>
                                <ColumnDefinition Width="20"/>
                                <ColumnDefinition Width="220"/>
                                <ColumnDefinition Width="20"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <!-- Left Panel: File List -->
                            <Border Grid.Column="0" BorderBrush="#C0C0C0" BorderThickness="1"
                                    Background="White" Padding="10">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <TextBlock Grid.Row="0" Text="Files:" FontWeight="Bold" Margin="0,0,0,10"/>

                                    <ListBox Grid.Row="1" ItemsSource="{Binding Files}"
                                             SelectedItem="{Binding SelectedFile, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                             Height="200" Margin="0,0,0,10">
                                        <ListBox.ItemTemplate>
                                            <DataTemplate>
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock Grid.Column="0" Text="{Binding FileName}"
                                                               ToolTip="{Binding FilePath}"/>
                                                    <TextBlock Grid.Column="1" Text="{Binding StatusText}"
                                                               Margin="10,0,0,0" FontSize="10"/>
                                                </Grid>
                                            </DataTemplate>
                                        </ListBox.ItemTemplate>
                                    </ListBox>

                                    <StackPanel Grid.Row="2" Orientation="Horizontal">
                                        <Button Content="➕ Add..." Command="{Binding AddFilesCommand}"
                                                Width="90" Margin="0,0,5,0"/>
                                        <Button Content="➖ Remove" Command="{Binding RemoveFileCommand}"
                                                Width="90" Margin="0,0,5,0"/>
                                        <Button Content="🗑 Clear" Command="{Binding ClearFilesCommand}"
                                                Width="90"/>
                                    </StackPanel>
                                </Grid>
                            </Border>

                            <!-- Middle Panel: Preview -->
                            <Border Grid.Column="2" BorderBrush="#C0C0C0" BorderThickness="1"
                                    Background="#202020" Padding="10">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <TextBlock Grid.Row="0" Text="Preview:" FontWeight="Bold"
                                               Foreground="White" Margin="0,0,0,10"/>

                                    <Border Grid.Row="1" BorderBrush="#404040" BorderThickness="1"
                                            Background="Black" Width="180" Height="180">
                                        <Image Source="{Binding PreviewImage}" Stretch="Uniform"/>
                                    </Border>

                                    <StackPanel Grid.Row="2" Margin="0,10,0,0">
                                        <TextBlock Text="{Binding PaletteStatus}" FontWeight="Bold"
                                                   Foreground="White" HorizontalAlignment="Center"/>
                                        <TextBlock Text="{Binding BitmapSize}" Foreground="#A0A0A0"
                                                   HorizontalAlignment="Center" FontSize="10" Margin="0,5,0,0"/>
                                    </StackPanel>
                                </Grid>
                            </Border>

                            <!-- Right Panel: Options & Convert -->
                            <Border Grid.Column="4" BorderBrush="#C0C0C0" BorderThickness="1"
                                    Background="White" Padding="15">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <!-- Output Directory -->
                                    <StackPanel Grid.Row="0" Margin="0,0,0,15">
                                        <TextBlock Text="Output Directory:" FontWeight="Bold" Margin="0,0,0,5"/>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBox Grid.Column="0" Text="{Binding OutputDirectory}"
                                                     IsReadOnly="True" Margin="0,0,5,0"/>
                                            <Button Grid.Column="1" Content="..." Width="30"
                                                    Command="{Binding BrowseOutputCommand}"/>
                                        </Grid>
                                    </StackPanel>

                                    <!-- Options -->
                                    <StackPanel Grid.Row="1" Margin="0,0,0,15">
                                        <TextBlock Text="Options:" FontWeight="Bold" Margin="0,0,0,10"/>

                                        <CheckBox Content="☑ Compress (zlib)" IsChecked="{Binding Compress}"
                                                  Margin="0,0,0,8"/>
                                        <CheckBox Content="☑ Rotate 90°" IsChecked="{Binding Rotate}"
                                                  Margin="0,0,0,8"/>

                                        <Grid Margin="0,5,0,0">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>

                                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Shrink:"
                                                       VerticalAlignment="Center" Margin="0,0,10,8"/>
                                            <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding ShrinkFactor}"
                                                     Width="60" HorizontalAlignment="Left" Margin="0,0,0,8"/>

                                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Name:"
                                                       VerticalAlignment="Center" Margin="0,0,10,8"/>
                                            <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding BitmapName}"
                                                     Margin="0,0,0,8"/>

                                            <TextBlock Grid.Row="2" Grid.Column="0" Text="X Offset:"
                                                       VerticalAlignment="Center" Margin="0,0,10,8"/>
                                            <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding XOffset}"
                                                     Width="60" HorizontalAlignment="Left" Margin="0,0,0,8"/>

                                            <TextBlock Grid.Row="3" Grid.Column="0" Text="Y Offset:"
                                                       VerticalAlignment="Center" Margin="0,0,10,0"/>
                                            <TextBox Grid.Row="3" Grid.Column="1" Text="{Binding YOffset}"
                                                     Width="60" HorizontalAlignment="Left"/>
                                        </Grid>
                                    </StackPanel>

                                    <!-- Progress -->
                                    <StackPanel Grid.Row="2" Margin="0,0,0,15">
                                        <TextBlock Text="{Binding StatusMessage}" FontWeight="Bold"
                                                   Margin="0,0,0,5" TextAlignment="Center"/>
                                        <ProgressBar Value="{Binding ProgressValue}" Height="25"
                                                     Maximum="100"/>
                                    </StackPanel>

                                    <!-- Convert Button -->
                                    <Button Grid.Row="4" Content="🚀 Convert All Files"
                                            Command="{Binding ConvertAllCommand}"
                                            Background="DarkGreen" Foreground="White"
                                            FontSize="14" FontWeight="Bold"
                                            Height="45"/>
                                </Grid>
                            </Border>
                        </Grid>

                        <!-- Info Section -->
                        <Border Grid.Row="2" BorderBrush="#E0E0E0" BorderThickness="0,1,0,0"
                                Padding="0,20,0,0" Margin="0,20,0,0">
                            <StackPanel>
                                <TextBlock Text="ℹ️ Requirements:" FontWeight="Bold" Margin="0,0,0,10"/>
                                <TextBlock Text="• BMP files must be 8-bit indexed" Margin="20,0,0,5"/>
                                <TextBlock Text="• Palette must have exactly 256 colors" Margin="20,0,0,5"/>
                                <TextBlock Text="• Use Meridian 59 standard palette (blakston.pal)" Margin="20,0,0,5"/>
                                <TextBlock Text="• Compress option uses zlib compression (recommended)" Margin="20,0,0,5"/>
                                <TextBlock Text="• Rotate 90° option is for wall textures" Margin="20,0,0,0"/>
                            </StackPanel>
                        </Border>
                    </Grid>
                </ScrollViewer>
            </TabItem>
        </TabControl>
    </Grid>
</Window>
